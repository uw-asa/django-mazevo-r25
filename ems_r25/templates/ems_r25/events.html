{% extends 'supporttools/base.html' %}

{% load staticfiles %}
{% load compress %}
{% load i18n %}

{% block content %}
<!-- page header -->
<div role="main" class="container-fluid">
<h2>Event Scheduler</h2>

	<!--  EVENT Search Block -->
	<div id="panel2" class="tab-pane event-search" role="tabpanel" aria-labelledby="tab2">
		<form role="form" class="form-inline event-search">
			
			<div class="form-group inputs-row">
				<label for="startdate" class="sr-only">Start date</label>
				<input id="startdate" type="date" class="form-control input-date" placeholder="mm/dd/yy" onfocus="this.placeholder = ''" onblur="this.placeholder = 'mm/dd/yy'" value="{{todays_date}}" min="{{todays_date}}" required>
			</div>
			<div class="form-group inputs-row">
				<label for="enddate" class="sr-only">End date</label>
				<input id="enddate" type="date" class="form-control input-date" placeholder="mm/dd/yy" onfocus="this.placeholder = ''" onblur="this.placeholder = 'mm/dd/yy'" value="{{thirty_date}}" min="{{todays_date}}" required>
			</div>
			<button type="submit" class="btn btn-primary">Search </button>
		</form>
		
        <div class="result-display-container event-search-result"></div>
	</div> <!-- .tab-pane. Form container-->

{% verbatim %}
<script id="event-search-result-template" type="text/x-handlebars-template">
  <div class="event-header"><!-- Rslt Header -->
	<h3><span class="sr-only"> Scheduling from</span> {{ search_startdate }} to {{ search_enddate }}</h3>
  </div>	<!-- .Rslt Header -->

  <div class="result-list-container">
  	<div class="result-header">
		<div class="pull-right clearfix batchswitch">
          {{> schedule-button}}
        </div>
  	</div>

    {{> event-list}}

  </div>
</script>
{% endverbatim %}


{% verbatim %}
<script id="event-search-result-empty-template" type="text/x-handlebars-template">
  <div class="event-header"><!-- Rslt Header -->
	<h3>No events from {{ search_startdate }} to {{ search_enddate }}</h3>
  </div>	<!-- .Rslt Header -->
</script>
{% endverbatim %}


{% verbatim %}
<script id="event-list-partial" type="text/x-handlebars-template">

  <ol class="list-group result-list-chunk">
    {{#each schedule}}
      <li class="list-group-item clearfix">
        <span class="result-row-date" title="date">{{ month_num }}/{{ day }}</span>
        <span class="result-row-day" title="day">{{ weekday }}</span> 
        <span class="result-row-time" title="time">{{ start_time }} - {{ end_time }}</span>
        <span class="result-row-room" title="room">{{ room }}</span>
        <span class="result-row-event" title="event name">{{ event_name }}</span>
        <!--Button Code-->
        <span class="pull-right result-row-switchbtn">
        {{> schedule-button}}
        </span>
        <!--End button-->
      </li>
    {{/each}}
  </ol>
</script>
{% endverbatim %}


{% verbatim %}
<script id="schedule-button-partial" type="text/x-handlebars-template">

<div class="schedule-button-cluster {{#if disabled}}disabled{{/if}}">
    <!-- loading status -->
        <span class="loading"><i class="fa fa-spinner fa-spin"></i></span>
    <!-- end status icons -->


    <!-- container for scheduler button, toggle, and resulting modal -->
    <div class="btn-group  {{#if r25_reservation_id}}scheduled {{#if synchronized}}synchronized{{else}}unsynchronized{{/if}}{{else}}unscheduled{{/if}}" {{#if booking_id}}data-booking-id="{{ booking_id }}"{{/if}}>

        <!-- scheduler button -->
        <button class="btn has-spinner" {{disabled}}>
            <span class="text scheduled synchronized option-help" id="text" data-toggle="tooltip" title="Unschedule this event"><i class="glyphicon glyphicon-ok"></i> Scheduled</span>
            <span class="text scheduled unsynchronized option-help" id="text" data-toggle="tooltip" title="Update this event"><i class="glyphicon glyphicon-refresh"></i> Scheduled</span>
            <span class="text unscheduled option-help" id="text" data-toggle="tooltip" title="Schedule this event">Schedule</span>
            <span class="text schedule-all option-help" id="text" data-toggle="tooltip" title="Schedule all events">Schedule All</span>
        </button>
        <!-- end scheduler button -->

        <!-- container for toggle and modal -->
        <div class="dropdown-container dropdown" style="display: inline-block;">

            <!-- button and modal toggle -->
            <button class="btn dropdown-toggle" {{disabled}} data-toggle="dropdown" data-placeholder="false">
                <span data-toggle="tooltip" title="Open dropdown containing settings for this recording">
                    <i class="fa fa-gear fa-2x"></i>
                </span>
                <span class="sr-only">Toggle Dropdown</span>
            </button>
            <!-- end toggle and modal -->


            <!-- recording settings modal -->
            <div class="dropdown-menu pull-right" role="menu">
              <span class="title">R25 Event</span>
              <ul>
                <li class="divider"></li>
                <li><div>
                    <div>
                        <a href="javascript:void(0);" title="Copy URL to clipboard" class="clipboard-copy xpull-right" onclick="copyToClipboard('.r25-event-url')"><i class="fa fa-clipboard"></i></a>
                    </div>
                    <a href="{{r25_event_url}}" class="r25-event-url" target="_blank">{{r25_event_name}}</a>
                </div></li>
                <li><div>Event ID:
                    <span class="pull-right"><input name="r25_event_id" value="{{ r25_event_id }}" /></span>
                </div></li>
                <li><div>Reservation ID:
                    <span class="pull-right"><input name="r25_reservation_id" value="{{ r25_reservation_id }}" /></span>
                </div></li>
              </ul>
            </div>
          <!-- end recording settings modal -->

        </div>
        <!-- end container for toggle and modal -->

    </div>
    <!-- end container for scheduler button, toggle, and resulting modal -->
</div>

</script>
{% endverbatim %}

</div> <!-- .container-fluid -->
<hr>

{% verbatim %}
<script id="ajax-waiting" type="text/x-handlebars-template">
  <div class="waiting">
    <i class="fa fa-spinner fa-4 fa-spin"></i>
  </div>
</script>
{% endverbatim %}

{% verbatim %}
<script id="ajax-state-waiting" type="text/x-handlebars-template">
  <span class="state-waiting">
    <i class="fa fa-spinner fa-spin"></i>
  </span>
</script>
{% endverbatim %}

{% verbatim %}
<script id="ajax-state-successful" type="text/x-handlebars-template">
  <span class="state-successful">
    <i class="fa fa-check" title="update successful"></i>
  </span>
</script>
{% endverbatim %}

{% verbatim %}
<script id="ajax-fail-tmpl" type="text/x-handlebars-template">
<div class="modal fade" id="failure-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <!-- Failure modal -->
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h3 class="modal-title" id="myModalLabel">{{ failure_title }}</h3>
      </div>
      <div class="modal-body">
		<p>{{{ failure_message }}}</p>
		<div style="display: none;">
          {{ full_failure_message }}
		</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
</script>
{% endverbatim %}

<script type="text/javascript">
window.scheduler = {
  csrftoken: '{{ csrf_token }}',
  r25_instance: '{{r25_instance}}',
  app_url: "{% url 'ems_r25' %}",
};
</script>

{% endblock content %}

{% block extra_css %}
{% compress css %}
<link rel="stylesheet" type="text/less" href="{% static "ems_r25/css/mobile.less" %}"/>
{% endcompress %}
{% if not request.is_mobile and not request.is_tablet %}
{% compress css %}
<link rel="stylesheet" type="text/less" href="{% static "ems_r25/css/desktop.less" %}"/>
{% endcompress %}
{% endif %}
{% endblock extra_css %}

{% block extra_js %}
{% compress js %}
<script src="{% static "vendor/js/moment.min.js" %}"></script>
<script src="{% static "ems_r25/js/main.js" %}"></script>
{% endcompress %}
{% endblock extra_js %}
